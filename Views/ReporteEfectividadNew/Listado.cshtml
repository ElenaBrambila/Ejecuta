@using IntegramsaUltimate.Models.FilterViewModel
@model ReporteEfectividadNewFilterViewModel
@{
    Layout = null;
}
<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<script src="~/Scripts/IntegramsaScript/ReporteEfectividad/ReporteEfectividadScript.js"></script>
<script src="~/Scripts/Utils/HttpAjaxServicesScript.js"></script>
<!--Report styles-->
<link href="~/Content/IntegransaStyles/ReporteEfectividad/reporte-efectividad-listado-styles.css" rel="stylesheet" />

<div class="row">

    <div class="col-md-12" style="padding-bottom: 1%;">
        <div id="buttons" style="padding-bottom: 1%;">
            <button type="button" onclick="tableToExcel('tableInfo', 'Reporte Efectivdad')" class="btn btn-primary buttonE">EXCEL</button>
            <button type="button" class="btn btn-primary buttonE" onclick="expandAll()">EXPANDIR</button>
            <button type="button" class="btn btn-primary buttonE" onclick="collapseAll()">COLAPSAR</button>
        </div>
        <div id="divTbl">
        </div>
    </div>
    <div class="loader-center" id="loading">
        <div class="loader-list">
            <div class="loader" id="loader"></div>
            <div class="one loader-bottom"></div>
        </div>
    </div>
</div>





<script>

    //Stick header to top
    $(document).ready(function (e) {
        //myTime = setInterval(loading, 200);
        var myModel = @Html.Raw(Json.Encode(Model));
        var url = '@Url.Content("~/ReporteEfectividadNew/ListadoPrueba")';

        //Ontiene los datos del servidor
        getReporteEfectividad(url,myModel)


        window.onscroll = function () { stickHeader() };

        function stickHeader() {
            var header = document.getElementById("mainHeading");
            var subheader = document.getElementById("mainSubHeading");
            var sticky = header.offsetTop;

            if (window.pageYOffset >= 300) {
                header.classList.add("sticky");
                subheader.classList.add("stickySub");
            } else {
                header.classList.remove("sticky");
                subheader.classList.remove("stickySub");
            }
        }

    });

</script>
    
